from flask import Blueprint, request, jsonify
from app.services.malware_service import MalwareService
from app.utils.encryption import Encryption

bp = Blueprint('malware', __name__)
malware_service = MalwareService()
encryption = Encryption()

@bp.route("/scan_malware", methods=["POST"])
def scan():
    encrypted_data = request.get_json()['data']
    decrypted_data = encryption.decrypt_message(encrypted_data)
    result = malware_service.scan_malware(decrypted_data)
    encrypted_result = encryption.encrypt_message(str(result))
    return jsonify({"result": encrypted_result})