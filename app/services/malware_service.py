from app.models.malware_detector import MalwareDetector

class MalwareService:
    def __init__(self, input_shape):
        self.malware_detector = MalwareDetector(input_shape)

    def scan_malware(self, data):
        # Assume data is preprocessed
        threats = self.malware_detector.detect(data)
        return {"threats": threats.tolist()}
