from app.models.malware_detector import MalwareDetector
from app.utils.data_preprocessor import preprocess_malware_data

class MalwareService:
    def __init__(self, input_shape):
        self.malware_detector = MalwareDetector(input_shape)

    def train_model(self, training_data, labels):
        preprocessed_data = preprocess_malware_data(training_data)
        self.malware_detector.train(preprocessed_data, labels)

    def scan_malware(self, data):
        preprocessed_data = preprocess_malware_data(data)
        threats = self.malware_detector.detect(preprocessed_data)
        return {"threats": threats.tolist()}